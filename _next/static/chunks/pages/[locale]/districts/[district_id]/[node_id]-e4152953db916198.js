(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[218],{2423:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[locale]/districts/[district_id]/[node_id]",function(){return i(6030)}])},7880:function(e,t,i){"use strict";i.d(t,{v:function(){return s}});var o=i(2784),n=i(8909);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Z,i=o.useRef(t),s=o.useRef([]);o.useEffect(()=>{i.current=t}),o.useEffect(()=>{let t=t=>{let o=Array.isArray(e)?e:[e],n=o.map(e=>e.toLowerCase()),a=t.key.trim().toLowerCase()||t.code.toLowerCase(),r=s.current.includes(a);if(r)return;s.current.push(a);let l=n.includes(a);l&&(console.log("key pressed",a),i.current(t))},o=e=>{let t=e.key.trim().toLowerCase()||e.code.toLowerCase();s.current=s.current.filter(e=>e!==t)};return window.addEventListener("keydown",t),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",o)}},[e])}},6030:function(e,t,i){"use strict";i.r(t),i.d(t,{__N_SSG:function(){return eW},default:function(){return eK}});var o,n,s=i(2322),a=i(2784),r=i(2285),l=i(5126),c=i(7046),u=i.n(c),d=i(6635),p=i(5632),h=i(3562),m=i(778),_=i(6364);class y extends m.m{async start(){}update(){}stop(){}reset(){}getDataPacketType(){return Math.random()<this.amountOfEmptyData?"empty":Math.random()<this.amountOfCorruptData?"corrupt":"data"}createNewPacket(){return{id:(0,_.Z)(),type:this.getDataPacketType(),status:"idle"}}getActivePackets(){return this.activePackets}onPacketEnterTargetArea(e){this.activePackets=[...this.activePackets,e]}onPacketExitTargetArea(e){let t=this.activePackets.find(t=>t.id===e.id);t&&"data"===t.type&&"idle"===t.status&&this.onInteractionFail({quiet:!0}),this.activePackets=this.activePackets.filter(t=>t.id!==e.id)}registerClick(){if(0===this.activePackets.length)return this.onInteractionFail({quiet:!0}),"fail";let e=this.activePackets.filter(e=>"idle"===e.status);if(0===e.length)return;let t=e.every(e=>"data"===e.type),i=e.some(e=>"corrupt"===e.type);if(t){for(let t of e)t.status="success";return this.onInteractionSuccess(),"success"}if(i){for(let t of e)t.status="fail";return this.onInteractionFail(),"fail"}}kill(){this.stop(),this.removeAllListeners()}constructor(){super(),this.successRate=0,this.boost=.05,this.injury=.02,this.amountOfCorruptData=.25,this.amountOfEmptyData=.1,this.activePackets=[],this.update=this.update.bind(this)}}var z=i(8909),f=i(1051),g=i(4748),T=i.n(g),v=i(2928),E=i(4217),I=i(3445);let O=(0,I.Ue)()(e=>({packets:[],addPacket:t=>{e(e=>({packets:[...e.packets,t]}))},removePacket:t=>{e(e=>({packets:e.packets.filter(e=>e.id!==t)}))},updatePacket:(t,i)=>{e(e=>{let o=e.packets.findIndex(e=>e.id===t);return -1===o?{}:{packets:[...e.packets.slice(0,o),{...e.packets[o],...i},...e.packets.slice(o+1)]}})},reset:()=>e({packets:[]})}));var w=i(6927),N=i(7880),b=i(4225),C=i(9542),R=i(1687),S=i(1544),k=i(3615);let U={MIN_SPEED:15,MAX_SPEED:45,DEBUG:!1,PACKET_SIZE:48,ANIMATION_STEP:24},x={LEARNING:.5,GAMEPLAY:1},L=a.forwardRef((e,t)=>{let{id:i,type:o,status:n="idle",decryptionAreaRect:r,canvasRect:l,onEnterTargetArea:c=z.Z,onExitTargetArea:u=z.Z,speedAdjustmentFactor:d,...p}=e,h=a.useRef(null),m=a.useRef(0),_=a.useRef(null),y=a.useRef(!1),[f]=a.useState(()=>(0,C.Qy)(U.MIN_SPEED,U.MAX_SPEED));return(0,a.useImperativeHandle)(t,()=>({id:i,getOffsetX:()=>m.current,update(e){if(m.current+=.01*e*f*d.get(),!h.current||!r.current||(_.current=h.current.getBoundingClientRect(),"empty"===o))return;let t=(0,E.WD)(_.current,r.current);t?y.current||(y.current=!0,c({id:i,type:o,status:n})):y.current&&(y.current=!1,u({id:i,type:o,status:n}))},show(){h.current&&(h.current.style.transform="translate3d(".concat(Math.floor(m.current/U.ANIMATION_STEP)*U.ANIMATION_STEP,"px, 0, 0)"))},isOffScreen:()=>!!_.current&&!!l.current&&_.current.left>l.current.right})),(0,s.jsx)("div",{ref:h,className:T().packet,"data-type":o,"data-status":n,...p})});L.displayName="Packet";var P=i(686);let M={TILE_SIZE:88,TILE_SPACING:16,TILE_CHARGE_TIMEOUT:1e3,TILE_SHOW_TIMEOUT:800,TILE_END_STATE_TIMEOUT:250};class A extends P.Z{setShowTimeout(e){this.showTimeout=e}setType(e){this.type=e}show(){this.setStatus("charging")}hide(){this.emit("hide",this.id),this.setStatus("idle")}registerClick(){if(!["charging","active"].includes(this.status)){this.setStatus("fail",{silentFail:!0});return}let e="data"===this.type,t="corrupt"===this.type;return e?(this.setStatus("success"),"success"):t?(this.setStatus("fail"),"fail"):void 0}handleTileExpired(){"active"===this.status&&("data"===this.type?(this.setStatus("fail"),this.emit("expired",this.id)):this.setStatus("idle"))}setStatus(e,t){switch(clearTimeout(this.timeoutId),e){case"idle":this.setType("empty");break;case"charging":this.timeoutId=setTimeout(()=>{this.setStatus("active")},this.chargetimeout);break;case"active":this.timeoutId=setTimeout(()=>{this.handleTileExpired()},this.showTimeout);break;case"success":case"fail":this.timeoutId=setTimeout(()=>{this.hide()},this.endStateTimeout),"success"===e&&this.emit("success",this.id),"fail"!==e||(null==t?void 0:t.silentFail)||this.emit("fail",this.id)}this.status=e,this.emit("update",this.id)}isAvailable(){return"idle"===this.status&&"empty"===this.type}kill(){this.removeAllListeners(),clearTimeout(this.timeoutId)}static getTileSize(){return M.TILE_SIZE}static getTileSpacing(){return M.TILE_SPACING}constructor({id:e,position:t,showTimeout:i=M.TILE_SHOW_TIMEOUT}){super(),this.type="empty",this.status="idle",this.position=[0,0],this.timeoutId=null,this.showTimeout=M.TILE_SHOW_TIMEOUT,this.chargetimeout=M.TILE_CHARGE_TIMEOUT,this.endStateTimeout=M.TILE_END_STATE_TIMEOUT,this.size=M.TILE_SIZE,this.id=e,this.position=t,this.showTimeout=i}}class j extends m.m{start(){this.currentTime=0,this.startTime=performance.now(),this.rafId=requestAnimationFrame(this.update),this.emit("start")}getTime(){return this.currentTime}shouldShowNewTile(){let e=this.tiles.filter(e=>!e.isAvailable()),t=(0,k.uZ)(Math.round(8*this.successRate),1,4);return e.length<t}showRandomTile(){let e=this.tiles.filter(e=>e.isAvailable());if(0===e.length)return;e.length>1&&(e=e.filter(e=>e.id!==this.lastShownTileIndex));let t=Math.floor(Math.random()*e.length),i=e[t],o=Math.random()<this.amountOfCorruptData?"corrupt":"data";i.setType(o),i.show()}stop(){cancelAnimationFrame(this.rafId),this.emit("stop")}update(e){this.currentTime=(e-this.startTime)*.001,this.deltaTime=this.currentTime-this.previousTime,this.previousTime=this.currentTime,this.rafId=requestAnimationFrame(this.update),"fail"===this.lastInteraction&&this.updateSuccessRate("subtract",this.deltaTime*this.damping),!(this.currentTime-this.previousTickTime<.05)&&(this.previousTickTime=this.currentTime,this.shouldShowNewTile()&&this.showRandomTile())}handleTileHit(e){let t=this.tiles[e],i=t.registerClick();this.lastInteraction=null!=i?i:"fail","success"===i?this.onInteractionSuccess():"fail"===i&&this.onInteractionFail()}handleTileMiss(){this.lastInteraction="fail"}handleDataTileExpired(){this.lastInteraction="fail"}onTileUpdate(){this.emit("update-tiles")}onTileHide(e){this.lastShownTileIndex=e}reset(){this.stop(),this.lastInteraction=void 0,this.tiles.forEach(e=>e.hide())}kill(){this.stop(),this.tiles.forEach(e=>e.kill()),this.removeAllListeners()}constructor(){super(),this.successRate=0,this.tilePositions=[[0,0],[.5,0],[1,0],[0,1],[.5,1],[1,1]],this.tiles=[],this.startTime=0,this.currentTime=0,this.previousTime=0,this.deltaTime=0,this.rafId=0,this.previousTickTime=0,this.boost=.06,this.injury=.04,this.damping=.01,this.amountOfCorruptData=.25,this.tiles=this.tilePositions.map((e,t)=>new A({id:t,position:e})),this._bind("update","showRandomTile","handleTileHit","handleTileMiss","handleDataTileExpired","onTileUpdate","onTileHide"),this.tiles.forEach(e=>{e.on("update",this.onTileUpdate),e.on("hide",this.onTileHide),e.on("expired",this.handleDataTileExpired)})}}var D=i(13),G=i.n(D),W=i(6231);let K=e=>{let{id:t,type:i,status:o,showKeyboardHints:n=!1,onClick:a=z.Z}=e;return(0,s.jsx)("div",{className:G().grid__tile,"data-type":i,"data-status":o,"data-id":t,"data-show-keyboard-hints":n,onClick:a,style:{"--charge-time":M.TILE_CHARGE_TIMEOUT+"ms"}})};var F=i(5400),B=i(2763),Y=i(2893),Z=i(7384),H=i(6176),q=i(5522),$=i(2794);(o=n||(n={})).ROOM_IS_FULL="ROOM_IS_FULL",o.ROOM_ID_NOT_FOUND="ROOM_ID_NOT_FOUND",o.COMMUNITY_ID_IN_USE="COMMUNITY_ID_IN_USE";let V=e=>{let t=(0,h.m_)(),{translate:i}=(0,l.$G)(),o=(0,p.useRouter)(),s=(0,H.qr)(e=>e.socketLink),c=(0,H.qr)(e=>e.userId),u=(0,B.L)(e=>e.dispatch),d=(0,B.L)(e=>e.config),m=(0,Z.D)(e=>e.privateRoomParams),_=(0,Z.D)(e=>e.isPrivateRoom),[y,z]=(0,a.useState)(void 0),f=(0,a.useMemo)(()=>({metadata:{streamId:null==d?void 0:d.uuid,participants:null==d?void 0:d.participants},uuid:c,accessToken:"SuperSecretPWord",decryptionLevel:0,partySize:null==d?void 0:d.participants}),[d,c]),g=0,T=2e3,v=async()=>{try{f.metadata.streamId="community";let t=s.joinCommunityRoom(m.port,m.roomId,f,e);t.then(e=>e).then(e=>{}).catch(e=>{switch(e.message){case n.ROOM_IS_FULL:u({type:"ATTEMPTING_TO_JOIN_FULL_ROOM"});break;case n.ROOM_ID_NOT_FOUND:u({type:"ROOM_PREVIOUSLY_USED"});break;default:console.log("Unable to connect to community room. Error:",e)}})}catch(e){console.log("Could not join community room. Error:",e),console.log("Reattemping connection..."),0===g&&u({type:"ATTEMPTING_NETWORK_RECONNECT"}),g<$.dh?(g++,console.log("Retrying in ".concat(T/1e3," seconds...")),setTimeout(v,T),T*=2):(u({type:"NETWORK_CONNECTION_LOST"}),console.error("Max retries to connect reached. Network connection lost."))}},E=async()=>{try{f.metadata.streamId="private";let t=s.joinPrivateRoom(m.port,m.roomId,f,e);t.then(e=>e).then(e=>{}).catch(e=>{switch(e.message){case n.ROOM_IS_FULL:u({type:"ATTEMPTING_TO_JOIN_FULL_ROOM"}),setTimeout(E,T);case n.ROOM_ID_NOT_FOUND:u({type:"ROOM_PREVIOUSLY_USED"});break;default:console.log("Unable to connect to private room. Error:",e)}})}catch(e){console.log("Could not join private room. Error:",e),console.log("Reattemping connection..."),0===g&&u({type:"ATTEMPTING_NETWORK_RECONNECT"}),g<$.dh?(g++,console.log("Retrying in ".concat(T/1e3," seconds...")),setTimeout(E,T),T*=2):(u({type:"NETWORK_CONNECTION_LOST"}),console.error("Max retries to connect reached. Network connection lost."))}},I=async()=>{try{let n=await s.createCommunityRoom(d.participants,q.R.RoomName.COMMUNITYROOM,f,e),a=window.location.origin+window.location.pathname;t(i("console_multi_private",{args:["".concat(a,"/#/").concat(n.roomId,"/").concat(n.port)],fallback:""})),z(n),o.replace(a+"/#/".concat(n.roomId,"/").concat(n.port))}catch(e){e.message===n.COMMUNITY_ID_IN_USE?u({type:"PRIVATE_ROOM_IN_USE"}):(console.log("Could not create community room. Error: ",e),console.log("Reattemping connection..."),0===g&&u({type:"ATTEMPTING_NETWORK_RECONNECT"}),g<$.dh?(g++,console.log("Retrying in ".concat(T/1e3," seconds...")),setTimeout(I,T),T*=2):(u({type:"NETWORK_CONNECTION_LOST"}),console.error("Max retries to connect reached. Network connection lost.")))}},O=async()=>{try{let n=await s.createPrivateRoom(null==d?void 0:d.participants,q.R.RoomName.PRIVATEROOM,f,e),a=window.location.origin+window.location.pathname;t(i("console_multi_private",{args:["".concat(a,"/#/").concat(n.roomId,"/").concat(n.port)],fallback:""})),z(n),o.replace(a+"/#/".concat(n.roomId,"/").concat(n.port))}catch(e){console.log("Could not create a private room. Error: ",e),console.log("Reattemping connection..."),0===g&&u({type:"ATTEMPTING_NETWORK_RECONNECT"}),g<$.dh?(g++,console.log("Retrying in ".concat(T/1e3," seconds...")),setTimeout(O,T),T*=2):(u({type:"NETWORK_CONNECTION_LOST"}),console.error("Max retries to connect reached. Network connection lost."))}},w=async()=>{try{let t=s.joinStreamRoom(q.R.RoomName.STREAMROOM,f,e);t.then(e=>e).then(e=>{}).catch(e=>{console.log("Unable to connect to stream room. Error:",e)})}catch(e){console.log("Could not join stream room. Error:",e),console.log("Reattemping connection..."),0===g&&u({type:"ATTEMPTING_NETWORK_RECONNECT"}),g<$.dh?(g++,console.log("Retrying in ".concat(T/1e3," seconds...")),setTimeout(w,T),T*=2):(u({type:"NETWORK_CONNECTION_LOST"}),console.error("Max retries to connect reached. Network connection lost."))}},N=async()=>{await (null==s?void 0:s.leaveRoom())},b=async()=>{d.isJoiningCommunityRoom?v():d.isJoiningPrivateRoom?E():d.decryptionType!==r.Ou.COMMUNITY_UNLOCK||d.isJoiningCommunityRoom?d.isMultiplayer&&_?O():w():I()};return(0,a.useEffect)(()=>{d&&s&&(s.isInRoom()?N().then(()=>{b()}).catch(e=>{console.log("Could not leave current room. Error:",e)}):b())},[d,s,_]),y},J=e=>{let{dispatch:t,config:i}=e,o=(0,H.qr)(e=>e.socketLink),n=(0,H.qr)(e=>e.userId),s=(0,h.m_)(),c=(0,Z.D)(e=>e.setNumberOfConnectedUsers),u=(0,Z.D)(e=>e.setLocalUserId),p=(0,B.L)(e=>{var t;return null===(t=e.config)||void 0===t?void 0:t.participants}),m=(0,B.L)(e=>e.setGlobalDecryptionLevel),_=(0,B.L)(e=>e.setRemoteUsersDecryptionLevel),y=(0,B.L)(e=>e.puzzleState),z=(0,a.useRef)(!1),f=(0,a.useRef)([]),g=(0,Z.D)(e=>e.setPrivateRoomParams);(0,w.n)(()=>(u(n),()=>{g(void 0),null==o||o.leaveRoom()})),(0,a.useEffect)(()=>{if("puzzle-success"===y&&o)try{o.updateUserDecryptionLevel(1)}catch(e){console.log("Cant update user decrpytion as the user is not in a room. Error:",e)}},[y,o]);let T=e=>{let t=e.payload,o=t.filter(e=>e.uuid!==n);if(o.length<f.current.length)for(let e=0;e<f.current.length;e++){let i=f.current[e];if(-1===t.findIndex(e=>e.uuid===i)){s((0,l.Iu)("console_multi_user_left",{args:[i],fallback:"A user has left the stream"})),f.current.splice(e,1);break}}c(t.length),-1===f.current.indexOf(t[t.length-1].uuid)&&t[t.length-1].uuid!==n&&((null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?s((0,l.Iu)("console_community_add",{args:[t.length,p],fallback:"A new user has joined the community"})):s((0,l.Iu)("console_multi_user_joined",{args:[t[t.length-1].uuid,t.length,p],fallback:"fallback err "})),f.current.push(t[t.length-1].uuid))},v=e=>{if(!z.current){let o=e.payload;c(o.length),e.payload.length===p&&((null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?t({type:"DECRYPTION_COMPLETE"}):setTimeout(()=>{t({type:"MULTIPLAYER_READY"}),z.current=!0},$.S9))}let o=[...e.payload].map(e=>e.decryptionLevel).reduce((e,t)=>e+=t,0)/e.payload.length;m(o);let s=e.payload.length>2?e.payload[2].decryptionLevel:e.payload[0].decryptionLevel,a=e.payload.length>3?e.payload[3].decryptionLevel:e.payload.length>2?o:e.payload[1].decryptionLevel;d.h.setState({channel1:e.payload[0].decryptionLevel,channel2:e.payload[1].decryptionLevel,channel3:s,channel4:a});let l=e.payload.filter(e=>e.uuid!==n);_(l),o>=$.d6&&t({type:"DECRYPTION_COMPLETE"})},E=V(e=>{switch(e.type){case Y.t.MessageType.CREATING_PARTY:T(e);break;case Y.t.MessageType.UPDATE_PARTY:v(e);break;case Y.t.MessageType.CONNECTION_LOST:t({type:"NETWORK_CONNECTION_LOST"});return}});return(0,a.useEffect)(()=>{(null==E?void 0:E.roomId)&&(null==E?void 0:E.port)&&g({roomId:E.roomId,port:E.port})},[E]),null};var X=i(9246),Q=i.n(X),ee=i(9374),et=i(3367),ei=i(7510);let eo=e=>{let{className:t}=e;return(0,s.jsxs)("svg",{className:t,height:"96",viewBox:"0 0 96 96",width:"96",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("mask",{id:"a",height:"96",maskUnits:"userSpaceOnUse",width:"96",x:"0",y:"0",children:(0,s.jsx)("path",{d:"m0 0h96v96h-96z",fill:"#d9d9d9"})}),(0,s.jsx)("g",{mask:"url(#a)",children:(0,s.jsx)("path",{clipRule:"evenodd",d:"m38.8649 29.4508h26.8231v29.3732h19.7289v-48.136h-46.552zm26.8231 36.1492h27.2969v-61.6h-61.688v25.4508h-27.2969v61.6h61.688zm-7.568 18.6748h-46.552v-48.136h46.552z",fillRule:"evenodd"})})]})};var en=i(5239);let es="undefined"==typeof navigator?"SSR":navigator.userAgent,ea=/android|webos|ip(hone|ad|od)|blackberry|iemobile|windows (ce|phone)|opera mini/i.test(es.toLowerCase());es.match(/SSR/i),/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(es.toLowerCase());let er=!!es.match(/Android/i),el=!!es.match(/iPhone|iPad|iPod/i);function ec(e,t){let i=t.match(e);return i&&i.length>0&&i[1]||void 0}es.match(/Opera Mini/i),es.match(/IEMobile/i),es.match(/safari|applewebkit/i)&&es.match(/chrome|crios|crmo/i),es.match(/chrome|crios|crmo/i),es.match(/(macintosh|macintel|macppc|mac68k|macos)/i),es.match(/firefox/i)&&es.match(/seamonkey/i),window.devicePixelRatio,/nexus\s4|galaxy\snexus/i.test(es),/nexus\s7|nexus\s10/i.test(es),~es.indexOf("Gecko")&&es.indexOf("KHTML"),/MSIE (\d+\.\d+);/.test(es),function(){let e=RegExp("(".concat("WebView|(iPhone|iPod|iPad)(?!.*Safari/)|Android.*(wv|.0.0.0)",")"),"ig");es.match(e)}(),function(){let e=es.match(/version\/(\d+)/i);if(e&&parseInt(e[1]),el){let e=es.match(/OS (\d+)_(\d+)_?(\d+)?/i);e&&parseInt(e[1])}er&&function(){let e=ec(/android\s([0-9\.]*)/i,es);e&&parseFloat(e)}()}(),function(){if(ec(/version\/(\d+(\.?_?\d+)+)/i,es)&&parseInt(ec(/version\/(\d+(\.?_?\d+)+)/i,es)),er){let e=ec(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,es);e&&parseInt(e)}}(),"ontouchstart"in window||window,/cros/.test(es.toLowerCase()),"undefined"!=typeof navigator&&"Microsoft Internet Explorer"===navigator.appName&&null!==es.match(/MSIE ([0-9]{1,}[.0-9]{0,})/)&&parseFloat(RegExp.$1);var eu=i(4145),ed=i(6461),ep=i(1737),eh=i(7452),em=i.n(eh),e_=i(8307),ey=i.n(e_),ez=i(7701);let ef=(0,ee.n)(Q(),"puzzleUI"),eg=e=>{let{puzzleState:t,config:i,dispatch:o}=e,n=(0,h.m_)(),c=a.useRef(3.5),[u,d]=a.useState(3.5),[m,_]=a.useState(!1),y=(0,Z.D)(e=>e.numberOfConnectedUsers),z=(0,Z.D)(e=>e.privateRoomParams),f=(0,Z.D)(e=>e.setIsPrivateRoom),g=(0,B.L)(e=>e.api),T=(0,p.useRouter)(),[v,E]=(0,a.useState)(""),{translate:I}=(0,l.$G)(),O=I("".concat(null==i?void 0:i.decryptionType,"-puzzle-info-title")),w=I("".concat(null==i?void 0:i.decryptionType,"-puzzle-info"));(0,eu.q)(()=>{_(!1),S()}),(0,a.useEffect)(()=>{i&&(E(I("puzzle-multiplayer-lobby-waiting-copy",{args:["".concat(y),"".concat(null==i?void 0:i.participants)]})),y===(null==i?void 0:i.participants)&&(i.decryptionType!==r.Ou.COMMUNITY_UNLOCK?n(I("console_multi_ready")):n(I("console_community_100")),E(I("puzzle-multiplayer-lobby-waiting-completed-copy"))))},[i,y]);let N=(0,a.useRef)(null);(0,a.useEffect)(()=>{switch(t){case"lobby-multiplayer-private":case"lobby-multiplayer-public":"lobby-multiplayer-public"!==N.current&&n(I("console_multi_asset_loading",{args:["".concat(null==i?void 0:i.participants)],fallback:"\n                  Loading asset...\n                  Analysing encryption...\n                  Encryption AES 128-bit\n                  Multiple users required to decrypt asset\n                  ".concat(null==i?void 0:i.participants," users required\n                  Use command 'private' to invite users to join")}));case"lobby-singleplayer":n(w);break;case"gameplay":(null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?n(I("console_community_loading",{fallback:"Retrieving connected users..."})):n(I("console_puzzle_start_decryption",{fallback:"Start decryption"}));break;case"puzzle-success":var e;n(I("console_puzzle_decryption_successful",{fallback:"Decryption successful"}));let o=(0,ep.K)(null!==(e=null==i?void 0:i.consoleInfo)&&void 0!==e?e:[]);(0,ed.xb)(o)||n(o),C();break;case"puzzle-complete-watch-asset":case"puzzle-complete-download-asset":n(I("console_puzzle_asset_rendering",{fallback:"Rendering asset..."})),n(I("console_puzzle_asset_rendered",{fallback:"Asset rendered"})),n(I("console_puzzle_reboot_countdown_start",{fallback:"Starting countdown to system reboot"})),c.current=20,R()}return N.current=t,()=>{_(!1),S()}},[t,n,I]);let b=a.useRef(void 0),C=()=>{setTimeout(()=>{o({type:"SUCCESS_TIMER_COMPLETE"})},3e3)},R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.current,t=e;b.current=setInterval(()=>{n("".concat(I("countdown_node_reset_prefix")," ").concat("≡".repeat(t)," ").concat(t)),d(--t),0===t&&(_(!0),clearInterval(b.current))},1e3)};a.useEffect(()=>{m&&o({type:"ASSET_VIEW_COUNTDOWN_COMPLETE"})},[m]);let S=()=>{b.current&&clearInterval(b.current)},[k,U]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e;return k&&(e=setTimeout(()=>{U(!1)},3e3)),()=>{e&&clearTimeout(e)}},[k]);let x=()=>{{let e=window.location.origin+window.location.pathname;navigator.clipboard.writeText("".concat(e,"/#/").concat(null==z?void 0:z.roomId,"/").concat(null==z?void 0:z.port)),U(!0),n(I("console_multi_private_copied"))}},[L,P]=(0,a.useState)(-100),[M,A]=(0,a.useState)(-100),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{if("puzzle-success"===t){if(!j.current){P(50),A(50);return}let e=j.current.getBoundingClientRect(),t=document.querySelector(".puzzleSketch"),i=document.querySelector(".scrollAreaContent");if(e&&t&&i){let o=t.getBoundingClientRect(),n=i.getBoundingClientRect(),s=ea?e.width+15:e.width/2+328,a=e.height+20+15,r=(o.left-(ea?-15:313))/n.width*100,l=(o.right-s)/n.width*100,c=(o.top-(ea?-15:0))/n.height*100,u=(o.bottom-a)/n.height*100;P(Math.floor(Math.random()*(l-r))+r),A(Math.floor(Math.random()*(u-c))+c)}else P(50),A(50)}},[t]);let[D,G]=(0,a.useState)(!1),W=()=>{T.push("/".concat(T.query.locale,"/districts/").concat(T.query.district_id))},K=()=>{g.set({config:{...i,isJoiningPrivateRoom:!1}}),f(!1),T.replace(window.location.origin+window.location.pathname),o({type:"LEAVE_PRIVATE_ROOM"})};return(0,s.jsx)("div",{className:ef(),"data-puzzle-state":t,"data-decryption-type":null==i?void 0:i.decryptionType,children:(0,s.jsxs)(en.M,{mode:"wait",children:["lobby-singleplayer"===t&&(0,s.jsxs)(ei.R,{id:"lobby-singleplayer-window",title:I("".concat(O)),children:[(0,s.jsx)("p",{className:ef("lobby-description"),children:I("".concat(w))}),(0,s.jsx)(et.z,{className:ef("lobby-cta"),onClick:()=>o({type:"CLICK_CTA"}),children:I("puzzle-start-button-label")})]},"lobby-singleplayer-window"),"lobby-multiplayer-private"===t&&(0,s.jsxs)(ei.R,{id:"lobby-multiplayer-window",title:I("".concat(O)),children:[(0,s.jsx)("p",{className:ef("lobby-description"),children:I("".concat(w))}),(0,s.jsx)("p",{className:ef("lobby-private-share-desc"),style:{opacity:z?1:0},children:I("puzzle-lobby-multiplayer-share-link-description")}),(0,s.jsx)(et.z,{style:{opacity:z?1:0},startIcon:k?void 0:(0,s.jsx)(eo,{className:ef("lobby-cta-icon")}),className:ef("lobby-share-cta"),onClick:x,children:k?I("puzzle-private-lobby-has-copied-url-label"):I("puzzle-private-lobby-copy-url-label")}),(0,s.jsx)("p",{className:ef("lobby-waiting-for-users"),children:v})]},"lobby-multiplayer-window"),"lobby-multiplayer-public"===t&&(0,s.jsxs)(ei.R,{id:"lobby-multiplayer-public-window",title:I("".concat(O)),children:[(0,s.jsx)("p",{className:ef("lobby-description"),children:I("".concat(w))}),(0,s.jsx)("p",{className:ef("lobby-waiting-for-users"),children:v})]},"lobby-multiplayer-public-window"),"gameplay"===t&&(null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK&&(0,s.jsxs)(ei.R,{id:"puzzle-community-gameplay-window",title:I("".concat(O)),theme:ei.$.GrayOnWhite,children:[(0,s.jsx)("p",{className:ef("lobby-description"),children:I("".concat(w),{args:[i.participants]})}),(0,s.jsx)("p",{className:ef("lobby-private-share-desc"),style:{opacity:z?1:0},children:I("puzzle-lobby-multiplayer-share-link-description")}),(0,s.jsx)(et.z,{style:{opacity:z?1:0},startIcon:k?void 0:(0,s.jsx)(eo,{className:ef("lobby-cta-icon")}),className:ef("lobby-share-cta"),onClick:x,children:k?I("puzzle-private-lobby-has-copied-url-label"):I("puzzle-private-lobby-copy-url-label")})]},"puzzle-community-gameplay-window"),"puzzle-success"===t&&(0,s.jsxs)(ei.R,{ref:j,id:"puzzle-success-window",title:I("puzzle-success-title"),theme:ei.$.GreenOnGreen,style:{position:"absolute",left:"".concat(L,"%"),top:"".concat(M,"%")},children:[(0,s.jsx)("p",{className:ef("puzzle-success-copy"),children:I("puzzle-success-decryption-complete")}),(0,s.jsx)("p",{className:ef("puzzle-success-copy"),children:I("puzzle-success-decryption-loading-asset",{args:[20]})})]},"puzzle-success-window"),"puzzle-complete-download-asset"===t&&!D&&(0,s.jsxs)(ei.R,{id:"puzzle-complete-download-asset-window",title:I("puzzle-download-title"),theme:ei.$.GrayOnGray,canExit:!0,onClose:()=>G(!0),children:[(0,s.jsx)("p",{className:ef("download-asset-copy"),children:I("puzzle-download-asset-information-copy",{args:[null==i?void 0:i.uuid,null==i?void 0:i.id]})}),(0,s.jsx)(et.z,{onClick:()=>{let e=null==i?void 0:i.downloadAsset,t=em().decrypt(e,ez.M).toString(ey());fetch(t).then(e=>e.blob()).then(e=>{let t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.style.display="none",o.download=null==i?void 0:i.uuid,document.body.appendChild(o),o.click()}).catch(e=>console.error(e))},className:ef("download-asset-cta"),children:(0,s.jsx)("p",{children:I("puzzle-download-asset-copy",{args:[(null==i?void 0:i.downloadAssetFileExtension)||""]})})})]},"puzzle-complete-download-asset-window"),"network-error"===t&&(0,s.jsxs)(ei.R,{id:"network-error-window",title:I("puzzle-network-error-title"),theme:ei.$.GrayOnGray,children:[(0,s.jsxs)("div",{className:ef("connection-lost-copy-container"),children:[(0,s.jsx)("p",{children:I("puzzle-connection-lost-copy")}),(0,s.jsx)("p",{children:I("puzzle-check-connection-copy")})]}),(0,s.jsx)("div",{className:ef("connection-lost-icon-container"),children:(0,s.jsx)("img",{className:ef("conection-lost-icon"),src:"/images/connection-lost-icon.svg"})})]},"network-error-window"),"attempting-network-reconnect"===t&&(0,s.jsxs)(ei.R,{id:"connecting-to-room-window",title:I("puzzle-loading-title"),theme:ei.$.GrayOnGray,children:[(0,s.jsxs)("div",{className:ef("connection-lost-copy-container"),children:[(0,s.jsx)("p",{children:I("puzzle-loading-weak-signal")}),(0,s.jsx)("p",{children:I("puzzle-loading-establishing-connection")})]}),(0,s.jsx)("div",{className:ef("connection-lost-icon-container"),children:(0,s.jsx)("img",{className:ef("conection-lost-icon"),src:"/images/connection-lost-icon.svg"})})]},"connecting-to-room-window"),"room-is-full"===t&&(0,s.jsxs)(ei.R,{id:"room-is-full-window",title:I("puzzle-room-is-full-title"),theme:ei.$.GrayOnWhite,children:[(0,s.jsx)("div",{className:ef("puzzle-is-full-copy-container"),children:(0,s.jsx)("p",{children:I("puzzle-room-is-full-description")})}),(null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?(0,s.jsx)(et.z,{onClick:W,children:(0,s.jsx)("p",{className:ef("puzzle-is-full-cta-copy"),children:I("puzzle-room-is-full-community-cta")})}):(0,s.jsx)(et.z,{onClick:K,children:(0,s.jsx)("p",{className:ef("puzzle-is-full-cta-copy"),children:I("puzzle-room-is-full-private-cta")})})]},"room-is-full-window"),"room-is-in-use"===t&&(0,s.jsxs)(ei.R,{id:"room-is-in-use-window",title:I("puzzle-room-is-in-use-title"),theme:ei.$.GrayOnWhite,children:[(0,s.jsx)("div",{className:ef("puzzle-is-in-use-copy-container"),children:(0,s.jsx)("p",{children:I("puzzle-room-is-in-use-description")})}),(null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?(0,s.jsx)(et.z,{onClick:W,children:(0,s.jsx)("p",{className:ef("puzzle-is-in-use-cta-copy"),children:I("puzzle-room-is-in-use-community-cta")})}):(0,s.jsx)(et.z,{onClick:K,children:(0,s.jsx)("p",{className:ef("puzzle-is-in-use-cta-copy"),children:I("puzzle-room-is-in-use-private-cta")})})]},"room-is-in-use-window"),"room-previously-used"===t&&(0,s.jsxs)(ei.R,{id:"room-previously-used-window",title:I("puzzle-room-previously-used-title"),theme:ei.$.GrayOnWhite,children:[(0,s.jsx)("div",{className:ef("puzzle-previously-used-copy-container"),children:(0,s.jsx)("p",{children:I("puzzle-room-previously-used-description")})}),(null==i?void 0:i.decryptionType)===r.Ou.COMMUNITY_UNLOCK?(0,s.jsx)(et.z,{onClick:W,children:(0,s.jsx)("p",{className:ef("puzzle-previously-used-cta-copy"),children:I("puzzle-room-previously-used-community-cta")})}):(0,s.jsx)(et.z,{onClick:K,children:(0,s.jsx)("p",{className:ef("puzzle-previously-used-cta-copy"),children:I("puzzle-room-previously-used-private-cta")})})]},"room-previously-used-window")]})})};var eT=i(2260);function ev(){return navigator.onLine}function eE(){return!0}function eI(e){return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}}var eO=i(1121),ew=i(6566),eN=i(5236);let eb=e=>{let{className:t}=e;return(0,s.jsxs)("svg",{className:t,width:"96",height:"97",viewBox:"0 0 96 97",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("g",{clipPath:"url(#clip0_229_1344)",children:(0,s.jsx)("path",{d:"M48 48.5C56.84 48.5 64 41.34 64 32.5C64 23.66 56.84 16.5 48 16.5C39.16 16.5 32 23.66 32 32.5C32 41.34 39.16 48.5 48 48.5ZM48 56.5C37.32 56.5 16 61.86 16 72.5V80.5H80V72.5C80 61.86 58.68 56.5 48 56.5Z"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_229_1344",children:(0,s.jsx)("rect",{width:"96",height:"96",fill:"white",transform:"translate(0 0.5)"})})})]})};var eC=i(8933),eR=i(7933),eS=i(3187),ek=i.n(eS);let eU=ek().createRandom(1);class ex{drawFrame(e,t,i,o,n){let{sprite:s,frames:a}=this,[r,l]=[s.width/a,s.height];this.ctx.image(s,t,i,o,n,e%a*r,Math.floor(e/a)*l,r,l)}constructor({ctx:e,sprite:t,frames:i=0}){this.ctx=e,this.sprite=t,this.frames=i}}let eL=e=>{let t,i,o;let n={},s=0,a=0,r=[],l=[],c=()=>{if(!t)return;let{width:i,height:o}=t.getBoundingClientRect();e.resizeCanvas(i,o)};e.preload=()=>{i=e.loadImage("/images/community_event_spritesheet.png")},e.setup=async()=>{let n=e.createCanvas(100,100);t=n.parent();let{width:s,height:a}=t.getBoundingClientRect();e.resizeCanvas(s,a),o=new ex({ctx:e,sprite:i,frames:21}),e.noSmooth(),e.noLoop()},e.updateWithProps=t=>{var i,o,u,d;let p=(null===(i=t.config)||void 0===i?void 0:i.participants)!==(null===(o=n.config)||void 0===o?void 0:o.participants);if(n=t,e.redraw(),p){let e=null!==(d=null===(u=n.config)||void 0===u?void 0:u.participants)&&void 0!==d?d:0;l=Array.from({length:e},(e,t)=>Math.floor(20*Math.random())+1),r=eU.shuffle(Array.from({length:e},(e,t)=>t));let[t,i]=(0,eR.p)(e);s=i,a=t,c()}},e.windowResized=c,e.draw=()=>{e.background(117,117,117);let[t,i]=[e.width/a,e.height/s];for(let e=0;e<a;e++)for(let u=0;u<s;u++){var c;let[s,d]=[e*t,u*i],p=e+u*a,h=r[p],m=!(0,ed.xb)(h)&&h<(null!==(c=n.numberOfConnectedUsers)&&void 0!==c?c:0);m?o.drawFrame(0,s,d,t,i):o.drawFrame(l[p],s,d,t,i)}}};var eP=i(2152);let eM={[r.Ou.MATCH_BEAT]:2,[r.Ou.PATTERN_UNLOCK]:2/3,[r.Ou.WHACK_A_MOLE]:1.6,[r.Ou.AUTO_ACCESS]:1.6,[r.Ou.COMMUNITY_UNLOCK]:1},eA=(e,t)=>{var i;return e===r.Ou.COMMUNITY_UNLOCK?(0,eR.g)(null==t?void 0:t.participants):null!==(i=eM[e])&&void 0!==i?i:1.6},ej={[r.Ou.MATCH_BEAT]:e=>{let{state:t,onSuccessRateChange:i=z.Z,onInteractionFail:o=z.Z,onInteractionSuccess:n=z.Z}=e,r=O(e=>e.packets),l=O(e=>e.addPacket),c=O(e=>e.removePacket),u=O(e=>e.updatePacket),d=O(e=>e.reset),p="gameplay"===t,h=a.useRef(null),m=a.useRef(null),_=a.useRef(null),g=a.useRef(null),{width:E,height:I}=(0,f.i)(),[C]=a.useState(()=>new y),[P,M]=a.useState(void 0),A=(0,b.y1)(()=>M(void 0),200),j=(0,R.c)(x.LEARNING);(0,w.n)(()=>(C.on("success",n),C.on("success",()=>{let e=C.getActivePackets();e.length?e.forEach(e=>{u(e.id,{status:"success"})}):console.warn("Cannot perform puzzle interaction success, active packet not found")}),C.on("fail",o),C.on("fail",()=>{let e=C.getActivePackets();e.length?e.forEach(e=>{u(e.id,{status:"fail"})}):console.warn("Cannot perform puzzle interaction fail, active packet not found")}),C.on("update-success-rate",i),C.on("update-success-rate",e=>{let t=(0,k.uZ)(e,0,.5),i=(0,k.UI)(t,0,.5,x.LEARNING,x.GAMEPLAY);(0,S.j)(j,i,{duration:4})}),()=>{C.kill(),d()})),a.useEffect(()=>{h.current&&_.current&&(g.current=_.current.getBoundingClientRect(),m.current=h.current.getBoundingClientRect())},[E,I,t]);let D=e=>{C.onPacketEnterTargetArea(e)},G=e=>{C.onPacketExitTargetArea(e)},W=()=>{if(!p)return;let e=C.registerClick();M(e),A()};(0,N.v)(["Space"],W);let K=a.useRef([]),F=a.useCallback((e,t)=>{(0===K.current.length||K.current[K.current.length-1].getOffsetX()>3*U.PACKET_SIZE)&&l(C.createNewPacket());for(let e=K.current.length-1;e>=0;e--)K.current[e].update(t),K.current[e].show(),K.current[e].isOffScreen()&&c(K.current[e].id)},[l,c,C]);return a.useEffect(()=>{if(p)return v.Z.add(F),()=>{v.Z.remove(F)}},[p,F]),(0,s.jsxs)("div",{ref:_,className:T().container,"data-debug":U.DEBUG,onClick:W,children:[(0,s.jsx)("div",{className:T().decryptionTool,ref:h,"data-status":P}),r.map(e=>(0,s.jsx)(L,{ref:e=>{if(e)K.current.push(e);else{let t=K.current.findIndex(t=>t===e);K.current.splice(t,1)}},...e,"data-debug":U.DEBUG,decryptionAreaRect:m,canvasRect:g,speedAdjustmentFactor:j,onEnterTargetArea:D,onExitTargetArea:G},e.id))]})},[r.Ou.PATTERN_UNLOCK]:F.gD,[r.Ou.WHACK_A_MOLE]:e=>{let{state:t}=e,[i]=a.useState(()=>new j),[o,n]=a.useState(i.tiles),r="gameplay"===t,l=(0,W.Y)();(0,w.n)(()=>(i.start(),i.on("update-success-rate",e.onSuccessRateChange),i.on("success",e.onInteractionSuccess),i.on("fail",e.onInteractionFail),i.on("update-tiles",()=>{n([...i.tiles])}),()=>{i.kill()})),a.useEffect(()=>{i&&(r?i.start():i.stop())},[r,i]);let c=e=>t=>{t.stopPropagation(),i.handleTileHit(e)};return(0,N.v)("q",c(0)),(0,N.v)("w",c(1)),(0,N.v)("e",c(2)),(0,N.v)("a",c(3)),(0,N.v)("s",c(4)),(0,N.v)("d",c(5)),(0,s.jsx)("div",{className:G().container,onClick:()=>{i.handleTileMiss()},children:(0,s.jsx)("div",{className:G().grid,children:o.map((e,t)=>(0,s.jsx)(K,{...e,onClick:c(t),showKeyboardHints:!l},e.id))})})},[r.Ou.AUTO_ACCESS]:()=>(0,s.jsx)(s.Fragment,{}),[r.Ou.COMMUNITY_UNLOCK]:e=>(0,s.jsx)(eC.g,{sketch:eL,...e})},eD=e=>{let{user:t}=e,i=(0,H.qr)(e=>e.userId),o=t.uuid===i,n=Math.round(100*t.decryptionLevel),{translate:a}=(0,l.$G)();return(0,s.jsxs)("div",{className:u().multiplayerUserContainer,children:[(0,s.jsxs)("div",{className:u().userContainer,children:[(0,s.jsx)(eb,{className:u().profileIcon}),(0,s.jsx)("p",{className:u().userId,children:o?"[".concat(a("puzzle-local-player-decryption-user-prefix"),"]"):"".concat(a("puzzle-remote-player-decryption-user-prefix")).concat(t.uuid.slice(0,3))})]}),(0,s.jsx)("div",{className:u().progressContainer,"data-section":n>66?"third":n>33?"second":"first",children:(0,s.jsxs)("p",{className:u().progressLabel,children:[n,"%"]})})]})},eG=e=>{let{isMultiplayer:t=!1}=e,i=(0,B.L)(e=>e.decryptionLevel),{translate:o}=(0,l.$G)();return(0,s.jsxs)("div",{className:u().scoresContainer,children:[(0,s.jsx)("p",{className:u().progressBarHeader,children:o("puzzle-local-decryption-title")}),(0,s.jsx)(eN.k,{className:u().localProgressBar,progressValue:100*i.global,theme:"white"}),t&&(0,s.jsx)("div",{className:u().otherPlayersContainer,children:i.users.map((e,t)=>(0,s.jsx)(eD,{user:e},t))})]})};var eW=!0;function eK(e){var t,i;let{streamNode:o}=e,n=(0,h.m_)(),c=(0,p.useRouter)(),m=(0,H.qr)(e=>e.socketLink),_=(0,ew.c)("desktopSmall"),{translate:y}=(0,l.$G)(),f=(0,H.qr)(e=>e.userId);(0,H.qr)(e=>e.isApplicationLocked);let g=(0,H.qr)(e=>e.setIsApplicationLocked),T=(0,B.L)(e=>e.config),v=(0,B.L)(e=>e.puzzleState),E=(0,B.L)(e=>e.dispatch),I=(0,B.L)(e=>e.reset),O=(0,B.L)(e=>e.setLocalUserDecryptionLevel),N=(0,B.L)(e=>e.setGlobalDecryptionLevel),b=null!==(t=null==T?void 0:T.isMultiplayer)&&void 0!==t&&t,C=(0,Z.D)(e=>e.numberOfConnectedUsers),R=(0,Z.D)(e=>e.isPrivateRoom),S=(0,Z.D)(e=>e.setPrivateRoomParams),k=(0,Z.D)(e=>e.setNumberOfConnectedUsers),U=(0,Z.D)(e=>e.setIsPrivateRoom),x=(0,B.L)(e=>e.api);(0,B.L)(e=>e.config),(0,B.L)(e=>e.puzzleState),(0,w.n)(()=>{let e=window.location,t=e.search;new URLSearchParams(t);let i=$.F8.test(window.location.href),n=i&&o.decryptionType!==r.Ou.COMMUNITY_UNLOCK,s=i&&o.decryptionType===r.Ou.COMMUNITY_UNLOCK,a=R||n;if(U(a),i){let e=window.location.href.match($.$z);S({roomId:e[1],port:parseInt(e[2])})}return x.set({puzzleState:"loading",config:{...o,isMultiplayerPublic:!a,isJoiningPrivateRoom:n,isJoiningCommunityRoom:s}}),N(0),O(f,0),()=>{I(),k(1),U(!1)}}),(0,w.n)(()=>{g(!1)}),(0,w.n)(()=>{let e=null==o?void 0:o.asset,t=null==o?void 0:o.backgroundColor1,i=null==o?void 0:o.backgroundColor2,n=null==o?void 0:o.assetFileExtension;if(!e){console.error("No asset url found"),E({type:"LOADED_WEBGL_ASSETS"});return}let s=/(jpg|jpeg|png|gif|webp|tiff|svg|mp4)$/i.test(n),a=e=>{e.type===d.zn.DecryptedEndComplete&&P()},r=()=>E({type:"LOADED_WEBGL_ASSETS"});return eT.Z.on(eT.F.WEBGL_ASSET_LOADED,r),eT.Z.on(eT.F.WEBGL_ASSET_LOAD_ERROR,r),d.h.getState().api.trigger.add(a),d.h.setState({assetUrl:e,effectPresetName:s?"default-image":"default",backgroundColor1:t,backgroundColor2:i}),()=>{d.h.getState().api.trigger.remove(a),d.h.getState().api.set({mapInTransitionFrom:"puzzle"}),eT.Z.off(eT.F.WEBGL_ASSET_LOADED,r),eT.Z.off(eT.F.WEBGL_ASSET_LOAD_ERROR,r)}}),(0,w.n)(()=>(n(y("console_node_stream_loading",{fallback:"Opening node stream\nNode stream encrypted"})),()=>{n(y("console_node_stream_closing",{fallback:"Closing node stream..."}))}));let L=a.useRef();a.useEffect(()=>{switch(v){case"gameplay":L.current=Date.now(),(0,eP.bq)({event:"started_decrypt_session",decrypt_info:{nodeId:null==o?void 0:o.id,userAmount:(null==o?void 0:o.isMultiplayer)?"multiuser":"singleuser",decryptionType:null==o?void 0:o.decryptionType}});break;case"puzzle-success":{let e=Date.now(),t=(0,ed.hj)(L.current)?Math.floor((e-L.current)/1e3):0;(0,eP.bq)({event:"completed_decrypt_session",decrypt_info:{nodeId:null==o?void 0:o.id,userAmount:(null==o?void 0:o.isMultiplayer)?"multiuser":"singleuser",decryptionType:null==o?void 0:o.decryptionType,timeSpent:t}});break}case"puzzle-complete-download-asset":case"puzzle-complete-watch-asset":d.h.getState().api.trigger.invoke({type:d.zn.DecryptedStart}),d.h.getState().api.decryptNode(o.id);break;case"puzzle-complete-outro-animation":d.h.getState().api.trigger.invoke({type:d.zn.DecryptedEnd})}},[v]);let P=a.useCallback(()=>{let e=c.asPath.split("/").slice(0,-1).join("/");c.push(e)},[]),M=a.useCallback(e=>{},[]),A=a.useCallback(e=>{d.h.getState().api.trigger.invoke({type:d.zn.GlitchError})},[]),j=(null==T?void 0:T.decryptionType)!==r.Ou.PATTERN_UNLOCK,D=a.useCallback(e=>{if(b){O(f,e);try{null==m||m.updateUserDecryptionLevel(e)}catch(e){console.log("error not in a room")}}else j&&(N(e),d.h.setState({channel1:e,channel2:e,channel3:e,channel4:e})),e>=$.wU&&E({type:"DECRYPTION_COMPLETE"})},[b,f,m,j]),G=a.useCallback(()=>{N(1),O(f,1)},[]),W=(0,a.useRef)($.nM[0]);a.useEffect(()=>B.R.subscribe(e=>e.decryptionLevel.global,e=>{let t=$.w5.find(t=>e>=t);if(t!==W.current&&(W.current=t,W.current>0)){let e=$.KT[W.current];n(y(e,{fallback:"".concat(100*W.current,"%")}))}}),[]);let K=function(){let e=(0,a.useSyncExternalStore)(eI,ev,eE);return e}();a.useEffect(()=>{E({type:K?"NETWORK_CONNECTION_RESTORED":"NETWORK_CONNECTION_LOST"})},[K]);let F=(null==T?void 0:T.decryptionType)?ej[null==T?void 0:T.decryptionType]:()=>(0,s.jsx)(s.Fragment,{}),Y=(null==T?void 0:T.decryptionType)!==r.Ou.AUTO_ACCESS,q=eA(null!==(i=null==T?void 0:T.decryptionType)&&void 0!==i?i:r.Ou.AUTO_ACCESS,T),V=![r.Ou.COMMUNITY_UNLOCK,r.Ou.PATTERN_UNLOCK].includes(null==T?void 0:T.decryptionType),X=(null==T?void 0:T.decryptionType)===r.Ou.COMMUNITY_UNLOCK?"".concat(C," / ").concat(null==T?void 0:T.participants):y("puzzle-container-title");return(0,s.jsx)("div",{className:u().container,children:(0,s.jsxs)(en.M,{mode:"wait",children:[(0,s.jsx)(eg,{isMultiplayer:o.isMultiplayer,config:T,puzzleState:v,dispatch:E},"puzzle-ui"),o.isMultiplayer&&(0,s.jsx)(J,{dispatch:E,config:T}),Y&&(0,s.jsx)(eO.v,{className:u().puzzleContainer,"data-puzzle-state":v,title:X,ratio:q,isFullscreen:_&&(null==T?void 0:T.decryptionType)===r.Ou.PATTERN_UNLOCK,config:T,progressBars:V?(0,s.jsx)(eG,{isMultiplayer:null==T?void 0:T.isMultiplayer}):null,windowProps:{active:"gameplay"===v},children:(0,s.jsx)(F,{"data-debug":!0,state:v,config:T,numberOfConnectedUsers:C,dispatch:E,decryptionType:null==T?void 0:T.decryptionType,solution:null==T?void 0:T.patternUnlockSolution,onSuccessRateChange:D,onInteractionSuccess:M,onInteractionFail:A,onDecryptionComplete:(null==T?void 0:T.isMultiplayer)?z.Z:G},"puzzle-sketch")},"puzzle-container")]})})}},2260:function(e,t,i){"use strict";i.d(t,{F:function(){return s},Z:function(){return n}});var o=i(686);let n=new o.Z,s={WEBGL_ASSET_LOADED:"WEBGL_ASSET_LOADED",WEBGL_ASSET_LOAD_ERROR:"WEBGL_ASSET_LOAD_ERROR"}},9246:function(e){e.exports={puzzleUI:"PuzzleUI_puzzleUI__MLwzI","puzzleUI__lobby-description":"PuzzleUI_puzzleUI__lobby-description__cHfux","puzzleUI__lobby-private-share-desc":"PuzzleUI_puzzleUI__lobby-private-share-desc__WPZQX","puzzleUI__lobby-share-url-container":"PuzzleUI_puzzleUI__lobby-share-url-container__ssQfm","puzzleUI__lobby-cta":"PuzzleUI_puzzleUI__lobby-cta__KRWRb","puzzleUI__lobby-cta-icon":"PuzzleUI_puzzleUI__lobby-cta-icon__UbxTx","puzzleUI__lobby-share-cta":"PuzzleUI_puzzleUI__lobby-share-cta__7ZAhj","puzzleUI__lobby-waiting-for-users":"PuzzleUI_puzzleUI__lobby-waiting-for-users__kP9Z6","puzzleUI__puzzle-success-copy":"PuzzleUI_puzzleUI__puzzle-success-copy__GaUa4","puzzleUI__download-asset-copy":"PuzzleUI_puzzleUI__download-asset-copy__1QMeP","puzzleUI__download-asset-cta":"PuzzleUI_puzzleUI__download-asset-cta__SpaRe","puzzleUI__connection-lost-copy-container":"PuzzleUI_puzzleUI__connection-lost-copy-container___C1AP","puzzleUI__connection-lost-icon-container":"PuzzleUI_puzzleUI__connection-lost-icon-container__DJyD_","puzzleUI__conection-lost-icon":"PuzzleUI_puzzleUI__conection-lost-icon__OAFPd","puzzleUI__puzzle-is-full-copy-container":"PuzzleUI_puzzleUI__puzzle-is-full-copy-container__RP1PW","puzzleUI__puzzle-is-in-use-copy-container":"PuzzleUI_puzzleUI__puzzle-is-in-use-copy-container__CszEq","puzzleUI__puzzle-previously-used-copy-container":"PuzzleUI_puzzleUI__puzzle-previously-used-copy-container__Na6kq"}},4748:function(e){e.exports={container:"MatchBeat_container__HAF8p",packet:"MatchBeat_packet__Fz81T",play:"MatchBeat_play__mDl9X",decryptionTool:"MatchBeat_decryptionTool__pS2IJ"}},13:function(e){e.exports={container:"Whack-a-mole_container__sot_z",grid:"Whack-a-mole_grid__okC9f",grid__tile:"Whack-a-mole_grid__tile__k2ANn",play:"Whack-a-mole_play__QEktm"}},7046:function(e){e.exports={container:"StreamNodePage_container__c8qwh",puzzleContainer:"StreamNodePage_puzzleContainer__s5pHT",scoresContainer:"StreamNodePage_scoresContainer__6AWxI",progressBarHeader:"StreamNodePage_progressBarHeader__ScaAp",localProgressBar:"StreamNodePage_localProgressBar__4Oh5_",otherPlayersContainer:"StreamNodePage_otherPlayersContainer__4HkbW",multiplayerUserContainer:"StreamNodePage_multiplayerUserContainer__GbuJd",userContainer:"StreamNodePage_userContainer__Poeyj",profileIcon:"StreamNodePage_profileIcon__VpkPG",userId:"StreamNodePage_userId__v5dHw",progressContainer:"StreamNodePage_progressContainer__dTxg9",progressLabel:"StreamNodePage_progressLabel__PHsMU",progressBar:"StreamNodePage_progressBar__I7qUl"}}},function(e){e.O(0,[544,251,774,888,179],function(){return e(e.s=2423)}),_N_E=e.O()}]);